$(document).ready((function(){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$("#wishlist-select").on("change",(function(){let t=$("#wishlist-select option:selected").data("wishlist-id"),e=$("#product_id").val();$.ajax({url:"/add_to_selected_wishlist",type:$(this).attr("method"),data:{wishlist_id:t,product_id:e},success:function(t){if(t.success)var e="alert-success";else e="alert-danger";let s=`<div class="alert ${e} mt-5 mb-5 text-center" style="position: relative;">${t.message}<button type="button" class="close" data-dismiss="alert" aria-label="Close" style="position: absolute; top: 50%; transform: translateY(-50%); right: 10px;">&times;</button></div>`;$("#wishlist-message-container").html(s)},error:function(t,e,s){}})})),$(document).on("click","li[data-wishlist-id]",(function(t){t.preventDefault();var e=$(this).data("wishlist-id");$.ajax({url:"/wishlist_infos",method:"POST",data:{wishlistId:e},success:function(t){if(t.length>0)$(".wishlist-info").empty(),t.forEach((function(t){let s=$('<div class="mt-3">').addClass("wishlist-item").addClass("border"),i=$("<input>").attr("type","hidden").addClass("product-id-input").val(t.productId),a=$("<input>").attr("type","hidden").addClass("wishlist-id-input").val(e),l=$("<input>").attr("type","hidden").addClass("product-name-input").val(t.productName),n=$("<button>").attr("type","button").addClass("btn btn-danger btn-sm btn-icon delete-product").html('<span class="ion-ios-close"></span>').css("border-radius","0").css("position","absolute").css("margin-top","10px").css("right","25px");s.append(i).append(a).append(l).append(n),$("<h3>").text(t.productName).appendTo(s);let d=$("<img>").attr("src","storage/"+t.productImage).attr("alt",t.productName).addClass("img-fluid img-thumbnail small-square-image");s.append(d),$("<p>").html('<span class="font-weight-bold">Prix :</span> '+t.productPrice).appendTo(s),$("<p>").html('<span class="font-weight-bold">Catégorie :</span> '+t.categoryName).appendTo(s),$("<p>").html('<span class="font-weight-bold">Description :</span> '+t.productDescription).appendTo(s),$("<p>").html('<span class="font-weight-bold">Date de création :</span> '+t.creationDate).appendTo(s),$(".wishlist-info").append(s)}));else{$(".wishlist-info").empty();let t='<div class="container"><div class="d-flex align-items-center justify-content-center" style="height: 40vh;"><div class="alert alert-danger text-center" role="alert">Vous n\'avez d\'article dans votre liste de souhaits.</div></div>';$(".wishlist-info").append(t)}},error:function(t,e,s){}})})),$(document).on("click",".delete-product",(function(){let t=parseInt($(this).siblings(".product-id-input").val()),e=parseInt($(this).siblings(".wishlist-id-input").val()),s=$(this).siblings(".product-name-input").val();$.ajax({url:"/delete_product",method:"POST",data:{productId:t,wishlistId:e,productName:s},success:function(t){t.success?($(".wishlist-info").empty(),$("#message").addClass("alert alert-success alert-dismissible text-center").html(t.message+'<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>'),$.ajax({url:"/wishlist_infos",method:"POST",data:{wishlistId:e},success:function(t){if(0==t.length){$(".wishlist-info").empty();let t='<div class="container"><div class="d-flex align-items-center justify-content-center" style="height: 40vh;"><div class="alert alert-danger text-center" role="alert">Vous n\'avez d\'article dans votre liste de souhaits.</div></div>';$(".wishlist-info").append(t)}},error:function(t,e,s){}})):($(".wishlist-info").empty(),$("#message").addClass("alert alert-danger alert-dismissible text-center").html(t.message+'<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>'))},error:function(t,e,s){}})})),$(document).on("click",".delete-wishlist",(function(){var t=$(this).closest("li").data("wishlist-id"),e=$(this).closest("li").data("wishlist-name");$.ajax({url:"/delete_wishlist",type:"POST",data:{wishlist_id:t,wishlist_name:e},success:function(t){t.success?($.ajax({url:"/refresh_wishlist",method:"GET",dataType:"json",success:function(t){var e=$("#wishlist-select");if(e.val(),e.empty(),t.length>0){var s=$("#list-wishlist");s.find(".active").data("wishlist-id"),s.empty(),t.forEach((function(t){var e=$("<li>").addClass("d-flex justify-content-between align-items-center mb-2").attr("data-wishlist-id",t.id).attr("data-wishlist-name",t.name);$("<a>").attr("href","#").text(t.name).appendTo(e),$("<button>").addClass("btn btn-danger btn-sm btn-icon delete-wishlist").html('<i class="ion-ios-trash"></i>').appendTo(e),e.appendTo(s)}));let e='<div class="container"><div class="d-flex align-items-center justify-content-center" style="height: 40vh;"><div class="alert alert-warning text-center" role="alert">Veuillez choisir une liste de souhait en cliquant sur son nom.</div></div></div>';$(".infos").html(e)}else{let t='<div class="empty-list"><div class="container"><div class="alert alert-danger text-center" role="alert">Vous n\'avez pas de liste de souhaits</div></div></div>';$("#list-wishlist").html(t);let e='<div class="container"><div class="d-flex align-items-center justify-content-center" style="height: 40vh;"><div class="alert alert-danger text-center" role="alert">Veuillez créer une liste de souhait. </div></div></div>';$(".infos").html(e)}},error:function(t,e,s){}}),$(".wishlist-item").remove(),$("#wishlist-count").text(`[${t.nbItemsWishlist}]`),$("#wishlist-message-delete-container").addClass("alert alert-success alert-dismissible text-center").html(t.message+'<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>')):$("#wishlist-message-delete-container").addClass("alert alert-danger alert-dismissible text-center").html(t.message+'<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>')},error:function(t){$("#wishlist-message-delete-container").html('<div class="alert alert-danger mt-5 mb-5 text-center" role="alert">Erreur lors de la suppression de la liste de souhaits.</div>')}})}))}));